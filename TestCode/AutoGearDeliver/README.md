Please refer to the src for up to date code.

This test code needs to be updated, and cleaned up. 